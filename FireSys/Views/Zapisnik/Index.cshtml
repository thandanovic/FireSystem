@model IEnumerable<FireSys.Entities.Zapisnik>

@{
    ViewBag.Title = "Zapisnici";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<script type="text/javascript">
    function OnClick(s, e) {
        var actionParams = $("form").attr("action").split("?OutputFormat=");
        actionParams[1] = s.GetMainElement().getAttribute("OutputFormatAttribute");
        $("form").attr("action", actionParams.join("?OutputFormat="));
    }

    function OnCreateClick(s, e) {
        $("#zapisnikModal").modal('show');
    }
    var commandName;
    function GridBeginCallback(s, e) {
        commandName = e.commandName;
    }

    function GridEndCallback(s, e) {
        console.log(commandName);
        commandName = null;
    }

    $(function () {

        function deleteRow() {
            var txt;
            var r = confirm("Da li zelite obrisati?");
            if (r == true) {
                return true;
            } else {
                return false;
            }
        }

        AttachReport();
        $(document).ajaxComplete(function (event, request, settings) {
            if (settings.data !== undefined && settings.data.includes('zapisnikGrid')) {
                function deleteRow() {
                    var txt;
                    var r = confirm("Da li zelite obrisati?");
                    if (r == true) {
                        return true;
                    } else {
                        return false;
                    }
                }

                AttachReport();
            }
        });

    });

</script>

@using (Html.BeginForm("ExportTo", "Zapisnik"))
{

    <div class="action-container margin-bottom-20 pull-right">
        <table>
            <tr>
                <td>
                    @*@Html.ActionLink("Kreiraj novog klijenta", "Create", null, new { @class = "btn btn-primary" })*@
                    @Html.DevExpress().Button(btn =>
               {
                   btn.Name = "btnNewZapisnik";
                   btn.Text = "Kreiraj novi zapisnik";
                   //btn.RouteValues = new { Controller = "Zapisnik", Action = "Create", ParamValue = "" };
                   btn.ControlStyle.CssClass = "create-button";
                   btn.ClientSideEvents.Click = "OnCreateClick";
               }).GetHtml()
                </td>
                <td>
                <td>
                    @Html.DevExpress().Button(btn =>
           {
               btn.Name = "btnExportToPDF";
               btn.Attributes["OutputFormatAttribute"] = "PDF";
               btn.Text = "PDF";
               btn.UseSubmitBehavior = true;
               btn.ClientSideEvents.Click = "OnClick";
               btn.ControlStyle.CssClass = "export-button";
           }).GetHtml()
                </td>
                <td>
                    @Html.DevExpress().Button(btn =>
           {
               btn.Name = "btnExportToXLSX";
               btn.Attributes["OutputFormatAttribute"] = "XLSX";
               btn.Text = "EXCEL";
               btn.UseSubmitBehavior = true;
               btn.ClientSideEvents.Click = "OnClick";
               btn.ControlStyle.CssClass = "export-button";
           }).GetHtml()
                </td>
            </tr>
        </table>
    </div>

    <br />


    @Html.Partial("ZapisnikGridView", Model)

}
